var requirejs,require,define;!function(global){function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){(c||!hasProp(a,e))&&(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(0===b||1==b&&".."===a[2]||".."===a[b-1])continue;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=c&&c.split("/"),r=x.map,s=r&&r["*"];if(a&&(a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),"."===a[0].charAt(0)&&q&&(p=q.slice(0,q.length-1),a=p.concat(a)),b(a),a=a.join("/")),d&&r&&(q||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),q)for(i=q.length;i>0;i-=1)if(f=getOwn(r,q.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(b.shift(),u.require.undef(a),u.makeRequire(null,{skipMap:!0})([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):-1===a.indexOf("!")?c(a,l,e):a:(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(apsp.apply(B,[B.length,0].concat(globalDefQueue)),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(g){a=g}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad&&req.onResourceLoad(u,this.map,this.depMaps)),l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(l){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+l,l,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&i(a,"error",bind(this,this.errback))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=x.shim,c={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){c[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,c){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),b[c]=a}),x.shim=b),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+x.urlArgs):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);return e(b.id)?void 0:j(makeError("scripterror","Script error for: "+b.id,a,[b.id]))}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.15",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a){var b=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return b.type=a.scriptType||"text/javascript",b.charset="utf-8",b.async=!0,b},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(){var a=!!window.jb_developmentMode,b={ko:"knockout",_:"lodash",q:"q",jquery:"jquery",moment:"moment-with-langs",path:"path",select2:"select2"},c={ko:"knockout.min",_:"lodash.min",q:"q.min",jquery:"jquery.min",moment:"moment-with-langs.min",path:"path.min",select2:"select2.min"},d=a?b:c;require.config({waitSeconds:45,baseUrl:"/js",paths:d,shim:{select2:["jquery"]}}),require(["polyfill","ko","jquery","moment","vm.main-nav","binding.ko-translate","binding.ko-datetext","binding.ko-datevalue","binding.ko-listtext","binding.ko-select2","router"],function(a,b,c,d,e){a.add(),d.lang(c("html").data("jb-locale")||window.window.navigator.userLanguage||window.navigator.language),b.applyBindings(e,c("#main-nav").get(0))})}(),define("vm.edit-post",["ko","logger","data.post","model-state","messenger"],function(a,b,c,d,e){var f=a.observable(null),g=new d,h=a.computed({read:function(){var a=f();return a?a.slug()?"[host]/post/"+a.slug():"[host]/post?id="+a._id:null},deferEvaluation:!0}),i=(a.computed({read:function(){var a=f();return a?a.date():null},deferEvaluation:!0}),a.observable(!1)),j=a.observable(!1),k=a.observable("SAVE"),l=a.observable("CANCEL_EDIT"),m=a.computed({read:function(){return j()||g.pristine()},deferEvaluation:!0}),n=a.computed({read:function(){return i()||g.pristine()},deferEvaluation:!0}),o=function(a){a?(j(!0),l("LOADING"),c.get(a).done(function(a){f(a),g.setModel(a)}).always(function(){j(!1),l("CANCEL_EDIT")})):(f(new c.PostDetails),g.setModel(f()))},p=function(a){var b;a&&a.params&&a.params.postId&&(b=a.params.postId),o(b)},q=function(a){a.checkValidity()&&(k("SAVING"),i(!0),c.save(f()).done(function(a){f(a),g.setModel(a),e.publish(e.messageNames.PostUpdated,a)}).always(function(){i(!1),k("SAVE")}))},r=function(){var b=a.unwrap(f),c=b?b._id:void 0;o(c)};return{activate:p,post:f,urlPreview:h,contentPreview:a.observable(!1),save:{"do":q,disabled:n,title:k},reload:{"do":r,disabled:m,title:l}}}),define("vm.files",["ko","_","data.files"],function(a,b,c){"use strict";var d=a.observableArray(),e=a.observable(),f=a.observable({orderBy:"name",asc:!0}),g=function(c,d){var e=a.unwrap(c),f=a.unwrap(d);b.each(e,function(a){a.visible(f?-1!==a.name.indexOf(f):!0)})},h=function(b,c){var d=a.unwrap(c);switch(d.orderBy){case"name":b.sort(function(a,b){return a.name===b.name?0:a.name>b.name?1:-1});break;case"date":b.sort(function(a,b){var c=a.date.valueOf(),d=b.date.valueOf();return c===d?0:c>d?1:-1});break;case"size":b.sort(function(a,b){return a.size===b.size?0:a.size>b.size?1:-1})}d.asc||b.reverse()},i=function(){c.query().done(function(b){d.removeAll(),a.utils.arrayPushAll(d,b),h(d,f),g(d,e)})},j=function(b){var i=b;c.upload(i).done(function(b){a.utils.arrayPushAll(d,b),h(d,f),g(d,e)})},k=function(){i()},l=function(a){c.remove(a.url).done(function(a){d.remove(function(b){return b.url===a})})};return f.subscribe(function(a){h(d,a)}),e.subscribe(function(a){g(d,a)}),{activate:k,filter:e,files:d,setSort:function(a){var b=f();f({orderBy:a,asc:a===b.orderBy?!b.asc:!0})},upload:j,remove:l}}),define("vm.log",["ko","_","data.log"],function(a,b,c){"use strict";var d=a.observableArray(),e=a.observable(),f=100,g=function(){c.query({limit:f}).done(function(a){d(a)})},h=function(){d().length||g()},i=function(a){a.expanded(!a.expanded())},j=function(){var e={limit:f},g=a.unwrap(d);g.length&&(e.afterId=b.last(g)._id),c.query(e).done(function(b){a.utils.arrayPushAll(d,b)})},k=function(){g()};return e.subscribe(function(c){var e=a.unwrap(d);b.each(e,function(a){a.visible(c?-1!==a.requestUrl.indexOf(c):!0)})}),{entries:d,activate:h,toggleExpand:i,filter:e,loadMore:j,refresh:k}}),define("vm.main-nav",["route-definition"],function(a){var b=[{href:"/",target:"_blank",titleKey:"BLOG"},{href:"/auth/logout",titleKey:"LOGOUT"},{href:"#!/posts",titleKey:"POSTS",icon:"glyphicon-th-list"},{href:a.definitions.misc.route,titleKey:"MISC",icon:"glyphicon-adjust"},{href:a.definitions.files.route,titleKey:"FILES",icon:"glyphicon-folder-open"},{href:"#!/edit",titleKey:"NEW_POST",icon:"glyphicon-plus"},{href:"#!/log",titleKey:"LOG_ENTRIES"}];return{navlinks:b}}),define("vm.misc",["ko","jquery","_","model-state","data.icons","data.navlink","data.settings","binding.ko-select2"],function(a,b,c,d,e,f,g,h){"use strict";var i=a.observableArray(),j=a.observableArray(),k=a.observable(new g.Model),l=a.computed({read:function(){return c.filter(i(),function(b){return!a.unwrap(b.willRemove)})},deferEvaluation:!0}),m=a.computed({read:function(){return c.filter(j(),function(b){return!a.unwrap(b.willRemove)})},deferEvaluation:!0}),n={mainNavlinks:new d(i),footerNavlinks:new d(j),settings:new d},o=function(a){switch(a){case"main":return i;case"footer":return j;default:return null}},p=function(a){switch(a){case"main":return n.mainNavlinks;case"footer":return n.footerNavlinks;default:return null}},q=a.observable(!1),r=a.observable(!1),s=a.observable(!1),t=a.observable(!1),u=function(a){var b=o(a),c=new f.Model({category:a});b.push(c)},v=function(a){a.willRemove(!0)},w=function(a,b){var c=o(b),d=c.indexOf(a);0===d||c().length<2||(c.splice(d,1),c.splice(d-1,0,a))},x=function(a,b){var c=o(b),d=c.indexOf(a);c().length<2||d===c().length-1||(c.splice(d,1),c.splice(d+1,0,a))},y=function(){f.query().done(function(b){var d=c.filter(b,function(a){return"main"===a.category}),e=c.filter(b,function(a){return"footer"===a.category});i.removeAll(),j.removeAll(),a.utils.arrayPushAll(i,d),a.utils.arrayPushAll(j,e),n.mainNavlinks.clear(),n.footerNavlinks.clear()}),g.get().done(function(a){k(a),n.settings.setModel(a)})},z=function(a){var b,c;for(b=0,c=a.length;c>b;b++)a[b].order(b)},A=function(a){var d,e,g=[];a=a||"main",e=p(a),d=o(a),z(d()),d.remove(function(a){return a.willRemove()&&!a._id}),t(!0),c.each(d(),function(a){g.push(a.willRemove()?f.remove(a._id).done(function(a){d.remove(function(b){return b._id===a._id})}):f.save(a).done(function(b){a._id||(a._id=b._id)}))}),b.when.apply(null,g).done(function(){e.clear()}).always(function(){t(!1)})},B=function(){t(!0),g.update(k()).done(function(){n.settings.clear()}).always(function(){t(!1)})},C={formatResult:h.formatGlyphicon,formatSelection:h.formatGlyphicon,escapeMarkup:function(a){return a},allowClear:!0},D=function(){y()};return{activate:D,mainNavlinks:{formId:"mainNavlinksForm",toggle:function(){q(!q())},visible:q,navlinks:l,add:function(){u("main")},save:function(){A("main")},saveDisabled:a.computed({read:function(){return n.mainNavlinks.pristine()||t()}}),icons:e.available,remove:v,up:function(a){w(a,"main")},down:function(a){x(a,"main")},select2IconOptions:C},footerNavlinks:{formId:"footerNavlinksForm",visible:r,toggle:function(){r(!r())},navlinks:m,add:function(){u("footer")},saveDisabled:a.computed({read:function(){return n.footerNavlinks.pristine()||t()}}),icons:e.available,remove:v,up:function(a){w(a,"footer")},down:function(a){x(a,"footer")},save:function(){A("footer")},select2IconOptions:C},appSettings:{formId:"settingsForm",settings:k,visible:s,toggle:function(){s(!s())},save:B,saveDisabled:a.computed({read:function(){return n.settings.pristine()||t()}})}}}),define("vm.posts",["ko","_","data.posts","data.post","data.files","messenger","logger"],function(a,b,c,d,e,f,g){"use strict";var h=16,i=a.observableArray(),j=a.observable(void 0),k=a.computed({read:function(){var a,c,d=j();return d?i().length<d.limit?null:(a=b.cloneDeep(d),a.skip=a.skip+a.limit,c="#!/posts/"+encodeURIComponent(JSON.stringify(a))):null}}),l=a.computed({read:function(){var a,c,d=j();return d?0===d.skip?null:(a=b.cloneDeep(d),a.skip=a.skip-a.limit,a.skip=a.skip>=0?a.skip:0,c="#!/posts/"+encodeURIComponent(JSON.stringify(a))):null}}),m=a.computed({read:function(){var a=j();return a?0===a.skip?null:"#!/posts":null}}),n=function(a){return a=a||{},a.hasOwnProperty("includeDraft")||(a.includeDraft=!0),a.skip=a.skip||0,a.limit=a.limit||h,a},o=function(){c.query(j()).done(function(b){i.removeAll(),a.utils.arrayPushAll(i,b)})},p=function(a){var c;if(a&&a.params&&a.params.query)try{c=JSON.parse(decodeURIComponent(a.params.query))}catch(d){g.log(d)}c=n(c),b.isEqual(c,j())||j(c)},q=function(a,b){window.confirm('Delete post "'+a.title+'" permanently? Really?')&&(b.currentTarget.disabled=!0,d.remove(a._id).done(o).always(t(b.currentTarget)))},r=function(a,b){window.confirm("Delete all posts?")&&window.confirm("Last chance to cancel removing of all posts. Really delete all posts?")&&(b.currentTarget.disabled=!0,d.remove("all").done(o).always(t(b.currentTarget)))},s=function(c){var d,e,f=a.unwrap(i);d=b.find(f,function(a){return a._id===c._id}),d&&(e=b.omit(c,["_id"]),b.each(e,function(b,c){a.isObservable(d[c])?d[c](a.unwrap(b)):d[c]=a.unwrap(b)}))},t=function(a){return function(){b.delay(function(){a.disabled=!1},500)}},u=function(a,b){var c=!a.draft();b.currentTarget.disabled=!0,d.savePlain({_id:a._id,draft:c}).done(s).always(t(b.currentTarget))},v=function(a,b){var c=!a.featured();b.currentTarget.disabled=!0,d.savePlain({_id:a._id,featured:c}).done(s).always(t(b.currentTarget))},w=function(a,b){var c=a;b.currentTarget.disabled=!0,e.uploadJsonPosts(c).done(o).always(t(b.currentTarget))};return j.subscribe(o),f.subscribe(f.messageNames.PostUpdated,o),{activate:p,posts:i,toggleDraft:u,toggleFeatured:v,remove:q,removeAll:r,uploadPosts:w,pagination:{nextPageUrl:k,prevPageUrl:l,startPageUrl:m}}}),define("route-definition",["_","jquery","ko","vm.posts","vm.edit-post","vm.misc","vm.files","vm.log"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(d){var e=this;this.view=d.view||"",this.viewModel=d.viewModel||null,this.enter=d.enter||null,this.on=d.on||null,this.exit=d.exit||null,this.state=d.state||null,this.route=d.route||"",this.applyBindingOnce=a.once(function(){e.viewModel&&a.isString(e.view)&&e.view.length&&c.applyBindings(e.viewModel,b(e.view).get(0))})},j=Object.freeze({posts:new i({view:"#admin-posts",viewModel:d,route:"#!/posts(/:query)",on:d.activate}),misc:new i({view:"#admin-misc",viewModel:f,route:"#!/misc",on:f.activate}),files:new i({route:"#!/files",viewModel:g,view:"#admin-files",on:g.activate}),edit:new i({view:"#admin-edit-post",viewModel:e,route:"#!/edit(/:postId)",on:e.activate}),log:new i({view:"#admin-view-log",viewModel:h,route:"#!/log",on:h.activate})});return{definitions:j,RouteDefinition:i}}),define("router",["jquery","path","ko","_","route-definition"],function(a,b,c,d,e){!function(){var c=e.definitions,f=function(b){d.isString(b.view)&&b.view.length&&a(b.view).show()},g=function(b){d.isString(b.view)&&b.view.length&&a(b.view).hide()},h=function(a){a.applyBindingOnce()},i=function(a){return function(){f(a),h(a),d.isFunction(a.enter)&&a.enter({state:a.state||null,params:this.params||null})}},j=function(a){return function(){d.isFunction(a.on)&&a.on({state:a.state||null,params:this.params||null})}},k=function(a){return function(){d.isFunction(a.exit)&&a.exit({state:a.state||null,params:this.params||null}),g(a)}};d.each(c,function(a){d.isString(a.route)&&b.map(a.route).enter(i(a)).to(j(a)).exit(k(a))}),b.root("#!/posts"),b.rescue(function(){alert("404: Route Not Found")}),b.listen()}()}),define("binding.ko-datetext",["ko","moment","_"],function(a,b,c){var d=function(a,d){var e,f;if(d=d||"LL",c.isDate(a))e=a;else{if(!c.isString(a)&&!c.isNumber(a))return a;e=new Date(a)}return f=b(e).format(d)};!function(){a.bindingHandlers.dateText={update:function(b,c,e){var f=$(b),g=a.utils.unwrapObservable(c()),h=e.get("date-format");f.text(d(g,h))}}}()}),define("binding.ko-datevalue",["ko"],function(a){!function(){var b=function(a){var b,c,d,e,f,g;if(!a)return"";if(b=a.getFullYear().toFixed(0),c=(a.getMonth()+1).toFixed(0),d=a.getDate().toFixed(0),b.length<4)for(f=0,g=4-b.length;g>f;f++)b="0"+b;return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),e=b+"-"+c+"-"+d},c=function(a){return a?new Date(a):null},d="input";a.bindingHandlers.dateValue={init:function(b,e){var f=e(),g=function(){var d=c(b.value);a.isObservable(f)?f(d):f=d};b.addEventListener(d,g),a.utils.domNodeDisposal.addDisposeCallback(b,function(){b.removeEventListener(d,g)})},update:function(c,d){var e=b(new Date(a.unwrap(d())));c.value=e}}}()}),define("binding.ko-select2",["ko","jquery","select2"],function(a,b){var c=function(a){var c,d,e,f=b(a.element),g=f.attr("value");return g?(c="glyphicon "+g,d=g.substring(10)):d="Select one",e=b("<span>").append(b("<span>").addClass(c)).append(b("<span>").text(d))};return function(){a.bindingHandlers.select2={init:function(c,d,e){var f,g;return b(c).select2(d()),f=e(),"function"==typeof(g=f.value).subscribe&&g.subscribe(function(a){return b(c).select2("val",a)}),a.utils.domNodeDisposal.addDisposeCallback(c,function(){return b(c).select2("destroy")})},update:function(a){return b(a).trigger("change")}}}(),{formatGlyphicon:c}}),define("binding.ko-listtext",["ko"],function(a){!function(){a.bindingHandlers.listText={init:function(b,c,d){var e,f=["change"],g=d.get("valueUpdate"),h=d.get("listSeparator")||" ",i=function(){var f=c(),g=a.selectExtensions.readValue(b),i=g.split(h);f&&a.isObservable(f)?a.isWriteableObservable(f)&&f(i):(e=d.get("_ko_property_writers"),e&&e.value&&e.value(i))};g&&("string"==typeof g&&(g=[g]),a.utils.arrayPushAll(f,g),f=a.utils.arrayGetDistinctValues(f)),a.utils.arrayForEach(f,function(c){var d=i;c.startsWith("after")&&(d=function(){setTimeout(i,0)},c=c.substring("after".length)),a.utils.registerEventHandler(b,c,d)})},update:function(b,c,d){var e=a.utils.unwrapObservable(c()),f=a.selectExtensions.readValue(b),g=d.get("listSeparator")||" ",h=e.join(g),i=h!==f;i&&a.selectExtensions.writeValue(b,h)}}}()}),define("binding.ko-translate",["ko","jquery","translate-service","messenger"],function(a,b,c,d){var e=function(a,d){c.getTextPromise(a).done(function(a){b(d).text(a)}).fail(function(){b(d).text(a)})};!function(){a.bindingHandlers.translate={init:function(b,c){d.subscribe({messageName:d.messageNames.TranslateLangChanged,callback:function(){e(a.unwrap(c()),b)},async:!0})},update:function(b,c){var d=a.unwrap(c());e(d,b)}}}()}),define("translate-service",["jquery","_","messenger"],function(a,b,c){"use strict";var d={},e={lang:a("html").data("jb-locale")||window.navigator.userLanguage||window.navigator.language,fallback:"en",url:"/api/locale"},f={},g=b.debounce(function(){c.publish(c.messageNames.TranslateLangChanged)},500,{leading:!1,trailing:!0}),h=function(a){return a&&(e.lang!==a.lang||e.fallback!==a.fallback||e.url!==a.url)&&(e=a,g()),e},i=function(b){var c,g=a.Deferred();return d.hasOwnProperty(b)?(g.resolve(d[b]),c=g.promise()):f.hasOwnProperty(b)?(f[b].done(g.resolve).fail(g.resolve),c=g.promise()):(a.get(e.url,{lang:b}).done(function(a){d[b]=a||[],g.resolve(a)}).fail(function(){d[b]=[],g.resolve(d[b])}).always(function(){delete f[b]}),c=g.promise(),f[b]=c),c},j=function(b){var c=a.Deferred();return i(e.lang).done(function(a){a.hasOwnProperty(b)?c.resolve(a[b]):i(e.fallback).done(function(a){c.resolve(a.hasOwnProperty(b)?a[b]:b)})}),c.promise()};return{config:h,getTextPromise:j}}),define("data.mapper",["ko","_","logger"],function(a,b,c){var d=function(a,d){var e,f;try{e=JSON.parse(d)}catch(g){c.log(g)}return e?f=b.isArray(e)?b.map(e,function(b){return new a(b)}):new a(e):null};return create=function(a){return function(b){return d(a,b)
}},{create:create}}),define("data.utils",["_","ko","logger"],function(a,b,c){var d=function(b){var c=b||this;return a.forOwn(c,function(b){a.isString(b)&&0===b.length&&(b=void 0)}),c},e=function(c){var d=c||this,e={};return a.forOwn(d,function(c,d){b.isObservable(c)?e[d]=c():a.isFunction(c)||(e[d]=c)}),e},f=function(a,b,d){c.log({status:b,error:d})};return{clearEmptyStrings:d,toPlain:e,onFail:f}}),define("data.files",["ko","jquery","data.mapper","data.utils"],function(a,b,c,d){var e=function(b){b=b||{},this.name=b.name,this.date=new Date(b.ctime),this.size=b.size,this.url=b.url,this.visible=a.observable(!0)},f=function(){return b.ajax({dataType:"json",type:"GET",url:"/api/upload",converters:{"text json":c.create(e)}}).fail(d.onFail)},g=function(a){var f=new FormData;return f.append("file_0",a),b.ajax({type:"POST",url:"/api/upload",data:f,processData:!1,contentType:!1,converters:{"text json":c.create(e)}}).fail(d.onFail)},h=function(a){return b.ajax({type:"DELETE",url:"/api/upload",data:{path:a}}).fail(d.onFail)},i=function(a){var c=new FormData;return c.append("file_json_posts",a),b.ajax({type:"POST",url:"/api/upload",data:c,processData:!1,contentType:!1}).fail(d.onFail)};return{Model:e,query:f,upload:g,remove:h,uploadJsonPosts:i}}),define("data.icons",[],function(){var a=["glyphicon-asterisk","glyphicon-plus","glyphicon-euro","glyphicon-minus","glyphicon-cloud","glyphicon-envelope","glyphicon-pencil","glyphicon-glass","glyphicon-music","glyphicon-search","glyphicon-heart","glyphicon-star","glyphicon-star-empty","glyphicon-user","glyphicon-film","glyphicon-th-large","glyphicon-th","glyphicon-th-list","glyphicon-ok","glyphicon-remove","glyphicon-zoom-in","glyphicon-zoom-out","glyphicon-off","glyphicon-signal","glyphicon-cog","glyphicon-trash","glyphicon-home","glyphicon-file","glyphicon-time","glyphicon-road","glyphicon-download-alt","glyphicon-download","glyphicon-upload","glyphicon-inbox","glyphicon-play-circle","glyphicon-repeat","glyphicon-refresh","glyphicon-list-alt","glyphicon-lock","glyphicon-flag","glyphicon-headphones","glyphicon-volume-off","glyphicon-volume-down","glyphicon-volume-up","glyphicon-qrcode","glyphicon-barcode","glyphicon-tag","glyphicon-tags","glyphicon-book","glyphicon-bookmark","glyphicon-print","glyphicon-camera","glyphicon-font","glyphicon-bold","glyphicon-italic","glyphicon-text-height","glyphicon-text-width","glyphicon-align-left","glyphicon-align-center","glyphicon-align-right","glyphicon-align-justify","glyphicon-list","glyphicon-indent-left","glyphicon-indent-right","glyphicon-facetime-video","glyphicon-picture","glyphicon-map-marker","glyphicon-adjust","glyphicon-tint","glyphicon-edit","glyphicon-share","glyphicon-check","glyphicon-move","glyphicon-step-backward","glyphicon-fast-backward","glyphicon-backward","glyphicon-play","glyphicon-pause","glyphicon-stop","glyphicon-forward","glyphicon-fast-forward","glyphicon-step-forward","glyphicon-eject","glyphicon-chevron-left","glyphicon-chevron-right","glyphicon-plus-sign","glyphicon-minus-sign","glyphicon-remove-sign","glyphicon-ok-sign","glyphicon-question-sign","glyphicon-info-sign","glyphicon-screenshot","glyphicon-remove-circle","glyphicon-ok-circle","glyphicon-ban-circle","glyphicon-arrow-left","glyphicon-arrow-right","glyphicon-arrow-up","glyphicon-arrow-down","glyphicon-share-alt","glyphicon-resize-full","glyphicon-resize-small","glyphicon-exclamation-sign","glyphicon-gift","glyphicon-leaf","glyphicon-fire","glyphicon-eye-open","glyphicon-eye-close","glyphicon-warning-sign","glyphicon-plane","glyphicon-calendar","glyphicon-random","glyphicon-comment","glyphicon-magnet","glyphicon-chevron-up","glyphicon-chevron-down","glyphicon-retweet","glyphicon-shopping-cart","glyphicon-folder-close","glyphicon-folder-open","glyphicon-resize-vertical","glyphicon-resize-horizontal","glyphicon-hdd","glyphicon-bullhorn","glyphicon-bell","glyphicon-certificate","glyphicon-thumbs-up","glyphicon-thumbs-down","glyphicon-hand-right","glyphicon-hand-left","glyphicon-hand-up","glyphicon-hand-down","glyphicon-circle-arrow-right","glyphicon-circle-arrow-left","glyphicon-circle-arrow-up","glyphicon-circle-arrow-down","glyphicon-globe","glyphicon-wrench","glyphicon-tasks","glyphicon-filter","glyphicon-briefcase","glyphicon-fullscreen","glyphicon-dashboard","glyphicon-paperclip","glyphicon-heart-empty","glyphicon-link","glyphicon-phone","glyphicon-pushpin","glyphicon-usd","glyphicon-gbp","glyphicon-sort","glyphicon-sort-by-alphabet","glyphicon-sort-by-alphabet-alt","glyphicon-sort-by-order","glyphicon-sort-by-order-alt","glyphicon-sort-by-attributes","glyphicon-sort-by-attributes-alt","glyphicon-unchecked","glyphicon-expand","glyphicon-collapse-down","glyphicon-collapse-up","glyphicon-log-in","glyphicon-flash","glyphicon-log-out","glyphicon-new-window","glyphicon-record","glyphicon-save","glyphicon-open","glyphicon-saved","glyphicon-import","glyphicon-export","glyphicon-send","glyphicon-floppy-disk","glyphicon-floppy-saved","glyphicon-floppy-remove","glyphicon-floppy-save","glyphicon-floppy-open","glyphicon-credit-card","glyphicon-transfer","glyphicon-cutlery","glyphicon-header","glyphicon-compressed","glyphicon-earphone","glyphicon-phone-alt","glyphicon-tower","glyphicon-stats","glyphicon-sd-video","glyphicon-hd-video","glyphicon-subtitles","glyphicon-sound-stereo","glyphicon-sound-dolby","glyphicon-sound-5-1","glyphicon-sound-6-1","glyphicon-sound-7-1","glyphicon-copyright-mark","glyphicon-registration-mark","glyphicon-cloud-download","glyphicon-cloud-upload","glyphicon-tree-conifer","glyphicon-tree-deciduous"];return{available:a}}),define("data.log",["jquery","ko","data.mapper","data.utils"],function(a,b,c,d){var e=function(a){var c;for(c in a)this[c]=a[c];this.asArray=[];for(c in this)"asArray"!==c&&"_id"!==c&&"__v"!==c&&this.asArray.push({name:c,value:this[c]});this.visible=b.observable(!0),this.expanded=b.observable(!1)},f=d.onFail,g=function(b){return a.ajax({dataType:"json",type:"GET",url:"/api/log",data:b,converters:{"text json":c.create(e)}}).fail(f)};return{Model:e,query:g}}),define("model-state",["ko","_"],function(a,b){"use strict";var c=function(c){var d,e=this,f=[],g=function(){e.setDirty()},h=function(c){b.forOwn(c,function(b){a.isObservable(b)&&f.push(b.subscribe(g)),h(a.unwrap(b))})},i=function(a){b.each(f,function(a){a.dispose()}),a&&d&&(d.dispose(),d=void 0),f.length=0},j=function(a){e.setDirty(),i(!1),h(a)},k=function(b){a.isObservable(b)&&(d=b.subscribe(j)),h(a.unwrap(b))};this.pristine=a.observable(!0),this.dirty=a.observable(!1),this.clear=function(){return e.pristine(!0),e.dirty(!1),e},this.setDirty=function(){return e.pristine(!1),e.dirty(!0),e},this.setModel=function(a){return i(!0),e.clear(),k(a),e},this.dispose=function(){i(!0)},c&&e.setModel(c)};return c}),define("data.navlink",["jquery","ko","data.mapper","data.utils"],function(a,b,c,d){var e=function(a){var c=this;a=a||{},this._id=a._id||void 0,this.text=b.observable(a.text),this.url=b.observable(a.url),this.category=a.category||"main",this.disabled=b.observable(a.disabled||!1),this.visible=b.observable(a.visible||!0),this.icon=b.observable(a.icon),this.order=b.observable(a.order||0),this.willRemove=b.observable(!1),this.newWindow=b.observable(a.newWindow||!1),this.useClientRouter=b.observable(a.useClientRouter||!1),this.newWindow.subscribe(function(a){a&&c.useClientRouter(!1)}),this.useClientRouter.subscribe(function(a){a&&c.newWindow(!1)})},f=d.onFail,g=function(b){return a.ajax({dataType:"json",type:"GET",url:"/api/navlinks",data:{category:b},converters:{"text json":c.create(e)}}).fail(f)},h=function(b){var g=d.toPlain(b);return d.clearEmptyStrings(g),a.ajax({dataType:"json",type:"POST",url:"/api/navlink",data:g,converters:{"text json":c.create(e)}}).fail(f)},i=function(b){return a.ajax({dataType:"json",type:"DELETE",url:"/api/navlink",data:{id:b},converters:{"text json":c.create(e)}}).fail(f)};return{Model:e,query:g,save:h,remove:i}}),define("data.post",["jquery","ko","_","data.mapper","data.utils"],function(a,b,c,d,e){var f=function(a){a=a||{},this._id=a._id||void 0,this.title=b.observable(a.title),this.date=b.observable(a.date?new Date(a.date):new Date),this.slug=b.observable(a.slug),this.featured=b.observable(!!a.featured),this.draft=b.observable(!!a.draft),this.content=b.observable(a.content),this.image=b.observable(a.image),this.metaTitle=b.observable(a.metaTitle),this.metaDescription=b.observable(a.metaDescription),this.tags=b.observableArray(a.tags)},g=e.onFail,h=function(b){var c=a.ajax({dataType:"json",type:"GET",url:"/api/post",data:{id:b},converters:{"text json":d.create(f)}}).fail(g);return c},i=function(b){var c,h;return h=e.toPlain(b),e.clearEmptyStrings(h),c=a.ajax({dataType:"json",type:"POST",url:"/api/post",data:h,converters:{"text json":d.create(f)}}).fail(g)},j=function(b){var c,c=a.ajax({dataType:"json",type:"POST",url:"/api/post",data:b}).fail(g);return c},k=function(b){var c=a.ajax({dataType:"json",type:"DELETE",url:"/api/post",data:{id:b},converters:{"text json":d.create(f)}}).fail(g);return c};return{PostDetails:f,get:h,save:i,savePlain:j,remove:k}}),define("data.posts",["jquery","ko","data.mapper","data.utils"],function(a,b,c,d){var e=function(a){a=a||{},this._id=a._id||void 0,this.title=a.title||"",this.date=a.date?new Date(a.date):new Date,this.slug=a.slug||"",this.featured=b.observable(!!a.featured),this.draft=b.observable(!!a.draft)},f=function(b){var f=a.ajax({dataType:"json",type:"GET",url:"/api/posts",data:b,converters:{"text json":c.create(e)}}).fail(d.onFail);return f};return{PostBrief:e,query:f}}),define("data.settings",["jquery","ko","data.mapper","data.utils"],function(a,b,c,d){"use strict";var e=function(a){a=a||{},this._id=a._id||void 0,this.authorDisplayName=b.observable(a.authorDisplayName||"Admin"),this.authorDisplayBio=b.observable(a.authorDisplayBio||void 0),this.authorTwitterScreenName=b.observable(a.authorTwitterScreenName||void 0),this.authorAvatarUrl=b.observable(a.authorAvatarUrl||null),this.footerAnnotation=b.observable(a.footerAnnotation||void 0),this.postsPerPage=b.observable(a.postsPerPage||5),this.siteTitle=b.observable(a.siteTitle||null),this.metaTitle=b.observable(a.metaTitle||null),this.metaDescription=b.observable(a.metaDescription||null),this.titleImageUrl=b.observable(a.titleImageUrl||null)},f=function(){return a.ajax({dataType:"json",type:"GET",url:"/api/settings",converters:{"text json":c.create(e)}}).fail(d.onFail)},g=function(b){var f=d.toPlain(b);return a.ajax({dataType:"json",type:"POST",url:"/api/settings",data:f,converters:{"text json":c.create(e)}}).fail(d.onFail)};return{Model:e,get:f,update:g}}),define("helpers-ui",["jquery"],function(a){"use strict";var b=function(){var a=window.document,b=a.hidden,c=a.webkitHidden;return b||c},c=function(b,c){var d,e=a(window),f={top:e.scrollTop(),left:e.scrollLeft()};return f.right=f.left+e.width(),f.bottom=f.top+e.height(),d=b.offset(),d.right=d.left+b.outerWidth(),d.bottom=d.top+b.outerHeight(),c?f.top<=d.top&&f.right>=d.right&&f.left<=d.left&&f.bottom>=d.bottom:!(f.right<d.left||f.left>d.right||f.bottom<d.top||f.top>d.bottom)},d=function(){a(window).scrollTop(0)};return{isDocumentHidden:b,isElementInViewport:c,scrollToTop:d}}),define("logger",["_"],function(a){var b=function(b){a.isString(b)};return{log:b}}),define("messenger",["_"],function(a){"use strict";var b={},c=function(c,d,e,f,g,h){var i,j={};return a.isString(c)?(j.messageName=c,j.callback=d,j.once=e,j.context=f,j.state=g,j.async=h):c&&(j=c),i={hash:a.uniqueId("m"),callback:j.callback,context:j.context,once:!!j.once,state:j.state,async:!!j.async},b.hasOwnProperty(j.messageName)||(b[j.messageName]=[]),b[j.messageName].push(i),i.hash},d=function(c){var d,e=-1;d=a.find(b,function(b){return e=a.findIndex(b,function(a){return a.hash===c}),e>-1}),e>-1&&a.isArray(d)&&d.splice(e,1)},e=function(c,d){var e,f,g,h,i,j=[],k=function(){h.callback.call(g,d,h.state)};if(b.hasOwnProperty(c)&&0!==b[c].length){for(i=b[c],e=0,f=i.length;f>e;e++)h=i[e],g=h.context||this,h.once&&j.push(h.hash),h.async?a.defer(k):k();a.remove(i,function(b){return a.some(j,function(a){return a===b.hash})})}},f=Object.freeze({TranslateLangChanged:"jb_translate_lang_changed",PostUpdated:"jb_post_updated",ContentUpdated:"jb_content_updated"});return{publish:e,subscribe:c,unSubscribe:d,messageNames:f}}),define("mobile-detection",[],function(){return{deviceMobile:!!window.jb_deviceMobile}}),define("polyfill",[],function(){var a=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}})};return{add:a}}),define("vm.base.translate",["ko"],function(a){a.computed({})});
//# sourceMappingURL=app-admin.min.js.map